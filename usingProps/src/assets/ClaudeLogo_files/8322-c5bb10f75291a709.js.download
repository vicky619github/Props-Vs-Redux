"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8322],{8322:function(e,t,n){n.d(t,{K5:function(){return E},Ql:function(){return O},Z1:function(){return b},_A:function(){return T},nJ:function(){return y},rN:function(){return S},wy:function(){return I},z6:function(){return k}});var r=n(36091),o=n(8571),a=n(40287),u=n(27218),c=n(27895),i=n(18850),l=n(93846),s=n(35228),f=n(6385),d=n(13262);n(92841);var v=n(87033),p=n(77930),g=n(81695),h=n(7653),m=n(19170),_=n(93513),w=n(68571);let k=()=>{let e=(0,g.useRouter)(),t=(0,a.f)();return{refresh:()=>{e.refresh()},switchAndRefresh:(e,n)=>{t.set(f.cn.LAST_ACTIVE_ORG,e),n?location.pathname=n:location.reload()}}},C=e=>{let{account:t}=(0,u.t)(),n=(0,l.gt)(e),o=(0,r.Wc)();return((0,h.useEffect)(()=>{t&&o()},[t,o]),t&&((0,s.wJ)({account:t,isClaudeDot:e})||(0,s.c6)(t,e)))?"/onboarding":t&&(0,s.kK)(t,e)?"/invites":t&&(0,s.D_)(t,e)?"/create":t&&n?"/upgrade":e?"/new":"/dashboard"};function E(e){let{value:t}=(0,v.FL)("show_affirmative_consent"),{value:n}=(0,v.FL)("show_affirmative_consent_for_privacy_policy");return(0,h.useMemo)(()=>[...t===e?["aup","consumer-terms"]:[],...n===e?["privacy"]:[]],[n,t,e])}let S=(e,t,n)=>{let r=(0,i.q)(),{mutateAsync:o}=(0,m.k7)();return(0,h.useCallback)(async()=>{if(!e||!r||0===t.length)return;let a=t.map(e=>({document_id:"v3:".concat(e,":").concat(r[e]),accepted_via_checkbox:n}));await o({acceptances:a})},[e,r,t,o,n])},T=(e,t)=>{let{account:n,refetch:r,setActiveOrganizationUUID:o}=(0,u.t)(),[a,i]=(0,h.useState)(!1),[l,s]=(0,h.useState)(!1),f=y(),{addSuccess:v}=(0,c.e)(),{data:g}=(0,m.gq)(e),_=(0,p.useQueryClient)();return(0,h.useEffect)(()=>{n&&a&&l&&(t?t(f):f())},[l,f,a,n,t]),(0,h.useCallback)(async()=>{var e,t;i(!0);let n=await r();await _.invalidateQueries({queryKey:[d.eW]}),(null==g?void 0:g.organization_uuid)&&(o(g.organization_uuid),v("Successfully joined ".concat(g.organization_name))),n&&(null===(t=window.google)||void 0===t?void 0:null===(e=t.accounts)||void 0===e?void 0:e.id)&&window.google.accounts.id.cancel(),s(!0)},[g,v,r,o,_])},y=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,g.useSearchParams)().get("returnTo"),n=I(e);return(0,h.useCallback)(()=>{n(t)},[n,t])},I=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{account:t}=(0,u.t)(),[n,r]=(0,h.useState)(!1),a=(0,g.useRouter)(),[c,i]=(0,h.useState)(null),l=(0,g.usePathname)(),s=(0,g.useSearchParams)(),f=(0,o.Z)(),d=C(f);return(0,h.useEffect)(()=>{(n||e)&&!t&&a.push((0,_.C2)(l,s.toString()))},[t,a,n,e,l,s]),(0,h.useEffect)(()=>{if(n&&t){let e=(0,_.eX)(t,c,d,f,!!w.env.NEXT_PUBLIC_SHOW_US_GOVT_SYSTEM_USE_NOTIFICATION);e!==window.location.href.replace(window.location.origin,"")&&(a.push(e),a.refresh())}},[t,a,n,c,d,f]),(0,h.useCallback)(e=>{e&&i(decodeURIComponent(e)),r(!0)},[])};function b(){let[e,t]=(0,h.useState)(!1);return{getRecaptchaToken:(0,h.useCallback)(async(e,n)=>w.env.NEXT_PUBLIC_DISABLE_RECAPTCHA?Promise.resolve("recaptcha-ignore-token"):(t(!0),new Promise((r,o)=>{if("undefined"==typeof grecaptcha)return t(!1),o(Error("Recaptcha failed to load"));grecaptcha.enterprise.ready(()=>{grecaptcha.enterprise.execute(e,{action:n}).then(e=>{r(e),t(!1)},e=>{t(!1),o(e)})})})),[]),isLoading:e}}function O(e){let[t,n]=(0,h.useState)(!1);(0,h.useEffect)(()=>{if(!t){let t=setInterval(()=>{(window.grecaptcha||w.env.NEXT_PUBLIC_DISABLE_RECAPTCHA)&&(n(!0),e())},10);return()=>clearInterval(t)}},[t,n,e])}},93513:function(e,t,n){n.d(t,{$6:function(){return i},C2:function(){return u},G9:function(){return c},eX:function(){return a},kY:function(){return l}});var r=n(35228),o=n(6385);let a=(e,t,n,a,u)=>{if(u&&!localStorage.getItem(o.VJ.ACCEPTED_US_GOVERNMENT_SYSTEM_NOTIFICATION))return"/us-govt-system-warning";if(!t||!t.startsWith("/"))return n;if((0,r.cG)(e,a)){let e=new URL(n,window.location.origin),r=new URLSearchParams(e.search);return r.set("returnTo",t),"".concat(e.pathname,"?").concat(r.toString())}return c(t)},u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/login",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o="".concat(e,"?").concat(t),a=new URLSearchParams(r);return a.append("returnTo",o),"".concat(n,"?").concat(a.toString())};function c(e){let t=new URL(e,"http://example.com");return t.pathname.replace(/^\/+/,"/")+t.search}function i(e){return e.reduce((e,t)=>{let n=localStorage.getItem(t);return null!==n&&e.push([t,n]),e},[])}function l(e){e.forEach(e=>{let[t,n]=e;localStorage.setItem(t,n)})}},36091:function(e,t,n){n.d(t,{ArkoseTokenProvider:function(){return m},Wc:function(){return w},mj:function(){return _}});var r=n(27573),o=n(5362),a=n(87033),u=n(88755),c=n(45144),i=n(27522),l=n(7653),s=n(41270),f=n(8571),d=n(18013);let v="ak-session-token",p=e=>{let{host:t,apiKey:n,nonce:o,onCompleted:u,onShown:f,onShow:d,onHide:v,onError:p,setArkoseEnforcement:g}=e,h=e=>{e.setConfig({onCompleted:u,onShown:f,onShow:d,onHide:v,onError:p}),g(e)};(0,l.useEffect)(()=>()=>{window.setupEnforcement=void 0},[]);let m=(0,a.Zr)("ak_integrity","integrity","",s.z.string());return(0,r.jsx)(i.default,{id:"arkose-script",src:"https://".concat(t,"/v2/").concat(n,"/api.js"),type:"text/javascript","data-callback":"setupEnforcement",async:!0,defer:!0,onLoad:()=>{window.setupEnforcement||(window.setupEnforcement=h)},onError:e=>(0,c.Tb)(e),nonce:o,integrity:m,crossOrigin:"anonymous"})},g=()=>{let e=(0,u.Q)(),t=(0,f.Z)(),{value:n}=(0,a.FL)("ak_enabled");return!e&&t&&n},h=(0,l.createContext)({isChallenging:!1,lastCallerId:void 0,needsToken:!1,startTokenFlow:()=>{}});function m(e){let{host:t,apiKey:n,nonce:o,children:a}=e,u=g(),[i,s]=(0,l.useState)(void 0),[f,m]=(0,l.useState)(void 0),[_,w]=(0,l.useState)(!1),[k,C]=(0,d.R)(v,void 0),E=u&&!k&&!!t&&!!n;return(0,r.jsxs)(h.Provider,{value:{isChallenging:_,needsToken:E,lastCallerId:f,startTokenFlow:e=>{m(e),null==i||i.run()}},children:[a,u&&t&&n&&(0,r.jsx)(p,{host:t,apiKey:n,nonce:o,onCompleted:e=>{C(e.token)},onShown:()=>w(!0),onShow:()=>w(!0),onHide:()=>w(!1),onError:e=>{(0,c.Tb)(e.error)},setArkoseEnforcement:s})]})}function _(){return(0,l.useContext)(h)}let w=()=>{let e=g(),[t,n,r]=(0,d.R)(v,void 0),{mutateAsync:a}=(0,o.uC)("api/arkose/verify","POST");return(0,l.useCallback)(async()=>{e&&t&&(r(),await a({session_token:t}))},[e,a,t,r])}},18850:function(e,t,n){n.d(t,{LegalDocsProvider:function(){return u},q:function(){return c}});var r=n(27573),o=n(7653);let a=(0,o.createContext)(void 0),u=e=>{let{value:t,children:n}=e;return(0,r.jsx)(a.Provider,{value:t,children:n})};function c(){return(0,o.useContext)(a)}},93846:function(e,t,n){n.d(t,{jN:function(){return p},Iq:function(){return m},gt:function(){return h},s$:function(){return v},fk:function(){return g}});var r=n(5362),o=n(40287),a=n(27895),u=n(6385),c=n(13262),i=n(87033),l=n(7653),s=n(40950),f=n(41270);let d=e=>{if(!e)return null;try{return JSON.parse(e)}catch(e){return null}};function v(){var e;let t=(0,o.f)();return{data:d(null!==(e=t.get(u.cn.PROMOTION))&&void 0!==e?e:null),mutate:(0,l.useCallback)(e=>{t.set(u.cn.PROMOTION,JSON.stringify(e),{maxAgeSeconds:7776e3})},[t]),delete:(0,l.useCallback)(()=>{t.delete(u.cn.PROMOTION)},[t])}}function p(){var e,t;let{data:n}=v();return t=null!==(e=null==n?void 0:n.promotionId)&&void 0!==e?e:null,(0,r.WE)("/api/billing/promotion/".concat(t),{queryKey:[c.Lx,t],enabled:!!t,meta:{noToast:!0}})}function g(){let{data:e,mutate:t}=v();(0,l.useEffect)(()=>{(null==e?void 0:e.needsCheckout)&&(e.needsCheckout=void 0,t(e))},[e,t])}function h(e){let{data:t,mutate:n}=v(),r=null==t?void 0:t.promotionId,o=(0,i.Zr)("claude_ai_targeted_promotion","promotionId",null,f.z.string().nullable());return(0,l.useEffect)(()=>{!r&&o&&n({promotionId:o})},[r,o,n]),!!e&&!!(null==t?void 0:t.needsCheckout)&&!!(null==t?void 0:t.promotionId)}let m=()=>{let e=(0,l.useRef)(!1),t=(0,a.e)(),n=(0,s.Z)(),{delete:r}=v();return(0,l.useCallback)(o=>{(null==o?void 0:o.offerError)&&!e.current&&(e.current=!0,t.addError(n.formatMessage({defaultMessage:"This promotion is not available for your account",id:"Vu9kt6ezVH"})),r())},[t,r,n])}}}]);